FROM oven/bun:1-alpine

WORKDIR /app

# Copy only what's needed for migrations
COPY package.json bun.lock ./
COPY prisma ./prisma/
COPY prisma.config.ts ./

# Install dependencies
RUN bun install --frozen-lockfile

# Generate Prisma client
RUN bun run prisma generate

# Default command - executes migrations
CMD ["bun", "run", "prisma", "migrate", "deploy"]
