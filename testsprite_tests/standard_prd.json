{
  "meta": {
    "project": "IT Job Hub Backend",
    "date": "2025-09-13",
    "prepared_by": "Software Development Manager"
  },
  "product_overview": "The IT Job Hub Backend is a comprehensive backend platform for managing job listings, companies, user profiles, authentication, comments, and likes within a professional job marketplace targeted at IT professionals.",
  "core_goals": [
    "Provide secure and efficient user authentication with JWT and HttpOnly cookies.",
    "Enable detailed user profile management including skills, availability, and social links.",
    "Offer full job management capabilities with advanced filtering, pagination, and batch import.",
    "Support comprehensive company profile management with CRUD operations and trust scoring.",
    "Facilitate user engagement through a robust comment system supporting nested replies and moderation.",
    "Implement a like system for jobs and comments to track user interactions.",
    "Ensure strong security through password hashing, role-based access control, input validation, and secure token handling.",
    "Maintain scalability and maintainability using modern tech stack with Prisma ORM and ElysiaJS framework."
  ],
  "key_features": [
    "User registration, login, token refresh, and logout with JWT and HttpOnly cookies.",
    "User profile CRUD operations supporting languages, skills, seniority, availability, CV upload, and social media links.",
    "Job listings with full CRUD, filtering by multiple criteria, pagination, and batch import capabilities.",
    "Company CRUD with pagination, detailed company info, and a trust score system.",
    "Comments on jobs with nested replies, editing, deletion, and user authorization.",
    "Like and unlike functionality for jobs and comments, with like count and user like status endpoints.",
    "Security measures including password hashing, token expiration, role-based access control, rate limiting, Helmet for security headers, and CORS configuration.",
    "OpenAPI/Swagger documented RESTful APIs for all features ensuring clear integration points."
  ],
  "user_flow_summary": [
    "User registers via /auth/register and receives authentication tokens via secured HTTP-only cookies.",
    "User logs in with email and password via /auth/login to receive JWT access and refresh tokens.",
    "Authenticated users can refresh tokens through /auth/refresh and logout with /auth/logout.",
    "Users can view and update their profile details via /users/me and /users/me/profile endpoints.",
    "Companies are managed by authorized users through CRUD endpoints with pagination support.",
    "Job posters create, update, delete, and list jobs with the ability to filter and paginate results.",
    "Users can comment on jobs and reply to other comments, edit or delete their comments via authorized requests.",
    "Users can like or unlike jobs and comments, and retrieve like counts or status for personalized interaction feedback."
  ],
  "validation_criteria": [
    "Successful user registration, login, and token refresh with appropriate status codes and error handling.",
    "User profile data can be created, retrieved, updated, and validated against input constraints.",
    "All job CRUD endpoints must enforce authorization and validation; filtering and pagination function as expected.",
    "Company CRUD operations properly store and retrieve data with pagination and security checks.",
    "Comment creation, retrieval with pagination, editing, and deletion are secured and functional with nested replies supported.",
    "Likes endpoints correctly handle creation, deletion, count retrieval, and user like status, preventing duplicate likes.",
    "Security features including password hashing, token expiration, HttpOnly cookie usage, role-based access control, input sanitation, and rate limiting are verifiable.",
    "API documentation is complete and accurate according to OpenAPI specs with appropriate request and response schemas."
  ],
  "code_summary": {
    "tech_stack": [
      "TypeScript",
      "Bun",
      "Elysia",
      "MongoDB",
      "Cassandra",
      "Prisma"
    ],
    "features": [
      {
        "name": "Authentication API",
        "description": "User authentication system with JWT tokens, registration, login, token refresh and logout",
        "files": [
          "src/routes/auth.ts",
          "src/services/auth/auth.service.ts"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Authentication API",
            "version": "1.0.0"
          },
          "paths": {
            "/auth/register": {
              "post": {
                "tags": [
                  "auth"
                ],
                "summary": "Register a new user",
                "requestBody": {
                  "required": true,
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "email": {
                            "type": "string",
                            "format": "email"
                          },
                          "password": {
                            "type": "string",
                            "minLength": 6
                          },
                          "firstName": {
                            "type": "string",
                            "minLength": 1
                          },
                          "lastName": {
                            "type": "string",
                            "minLength": 1
                          }
                        }
                      }
                    }
                  }
                },
                "responses": {
                  "201": {
                    "description": "User registered successfully"
                  },
                  "400": {
                    "description": "Bad request"
                  }
                }
              }
            },
            "/auth/login": {
              "post": {
                "tags": [
                  "auth"
                ],
                "summary": "Login user",
                "requestBody": {
                  "required": true,
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "email": {
                            "type": "string",
                            "format": "email"
                          },
                          "password": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "Login successful"
                  },
                  "401": {
                    "description": "Invalid credentials"
                  }
                }
              }
            },
            "/auth/refresh": {
              "post": {
                "tags": [
                  "auth"
                ],
                "summary": "Refresh authentication token",
                "responses": {
                  "200": {
                    "description": "Token refreshed successfully"
                  },
                  "401": {
                    "description": "Invalid refresh token"
                  }
                }
              }
            },
            "/auth/logout": {
              "post": {
                "tags": [
                  "auth"
                ],
                "summary": "Logout user",
                "responses": {
                  "200": {
                    "description": "Logged out successfully"
                  },
                  "500": {
                    "description": "Failed to logout"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "User Management API",
        "description": "User profile management with CRUD operations for user data and profiles",
        "files": [
          "src/routes/users.ts",
          "src/services/users/user.service.ts"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "User Management API",
            "version": "1.0.0"
          },
          "paths": {
            "/users/me": {
              "get": {
                "tags": [
                  "users"
                ],
                "summary": "Get current user profile",
                "security": [
                  {
                    "BearerAuth": []
                  }
                ],
                "responses": {
                  "200": {
                    "description": "User data retrieved successfully"
                  },
                  "401": {
                    "description": "Unauthorized"
                  },
                  "404": {
                    "description": "User not found"
                  }
                }
              }
            },
            "/users/{id}/profile": {
              "get": {
                "tags": [
                  "users"
                ],
                "summary": "Get user profile by ID",
                "parameters": [
                  {
                    "name": "id",
                    "in": "path",
                    "required": true,
                    "schema": {
                      "type": "string"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Profile retrieved successfully"
                  },
                  "404": {
                    "description": "Profile not found"
                  }
                }
              }
            },
            "/users/me/profile": {
              "put": {
                "tags": [
                  "users"
                ],
                "summary": "Update user profile",
                "security": [
                  {
                    "BearerAuth": []
                  }
                ],
                "requestBody": {
                  "required": true,
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "languages": {
                            "type": "array",
                            "items": {
                              "type": "string"
                            }
                          },
                          "skills": {
                            "type": "array",
                            "items": {
                              "type": "string"
                            }
                          },
                          "seniority": {
                            "type": "string"
                          },
                          "availability": {
                            "type": "string"
                          },
                          "bio": {
                            "type": "string"
                          },
                          "github": {
                            "type": "string"
                          },
                          "linkedin": {
                            "type": "string"
                          },
                          "website": {
                            "type": "string"
                          },
                          "cvUrl": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "Profile updated successfully"
                  },
                  "401": {
                    "description": "Unauthorized"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Job Management API",
        "description": "Complete job posting system with CRUD operations, filtering, pagination, and batch import functionality",
        "files": [
          "src/routes/jobs.ts",
          "src/services/jobs/job.service.ts"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Job Management API",
            "version": "1.0.0"
          },
          "paths": {
            "/jobs": {
              "post": {
                "tags": [
                  "jobs"
                ],
                "summary": "Create a new job",
                "security": [
                  {
                    "BearerAuth": []
                  }
                ],
                "requestBody": {
                  "required": true,
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "title": {
                            "type": "string",
                            "minLength": 1
                          },
                          "description": {
                            "type": "string",
                            "minLength": 1
                          },
                          "companyId": {
                            "type": "string"
                          },
                          "location": {
                            "type": "string"
                          },
                          "salaryMin": {
                            "type": "number"
                          },
                          "salaryMax": {
                            "type": "number"
                          },
                          "seniority": {
                            "type": "string"
                          },
                          "skills": {
                            "type": "array",
                            "items": {
                              "type": "string"
                            }
                          },
                          "remote": {
                            "type": "boolean"
                          }
                        }
                      }
                    }
                  }
                },
                "responses": {
                  "201": {
                    "description": "Job created successfully"
                  },
                  "401": {
                    "description": "Unauthorized"
                  },
                  "403": {
                    "description": "Forbidden"
                  }
                }
              },
              "get": {
                "tags": [
                  "jobs"
                ],
                "summary": "Get all jobs with pagination and filters",
                "parameters": [
                  {
                    "name": "page",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  },
                  {
                    "name": "limit",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  },
                  {
                    "name": "companyId",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  },
                  {
                    "name": "location",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  },
                  {
                    "name": "seniority",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  },
                  {
                    "name": "remote",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  },
                  {
                    "name": "skills",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Jobs retrieved successfully"
                  }
                }
              }
            },
            "/jobs/{id}": {
              "get": {
                "tags": [
                  "jobs"
                ],
                "summary": "Get job by ID",
                "parameters": [
                  {
                    "name": "id",
                    "in": "path",
                    "required": true,
                    "schema": {
                      "type": "string"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Job retrieved successfully"
                  },
                  "404": {
                    "description": "Job not found"
                  }
                }
              },
              "put": {
                "tags": [
                  "jobs"
                ],
                "summary": "Update job",
                "security": [
                  {
                    "BearerAuth": []
                  }
                ],
                "parameters": [
                  {
                    "name": "id",
                    "in": "path",
                    "required": true,
                    "schema": {
                      "type": "string"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Job updated successfully"
                  },
                  "401": {
                    "description": "Unauthorized"
                  },
                  "403": {
                    "description": "Forbidden"
                  },
                  "404": {
                    "description": "Job not found"
                  }
                }
              },
              "delete": {
                "tags": [
                  "jobs"
                ],
                "summary": "Delete job",
                "security": [
                  {
                    "BearerAuth": []
                  }
                ],
                "parameters": [
                  {
                    "name": "id",
                    "in": "path",
                    "required": true,
                    "schema": {
                      "type": "string"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Job deleted successfully"
                  },
                  "401": {
                    "description": "Unauthorized"
                  },
                  "403": {
                    "description": "Forbidden"
                  },
                  "404": {
                    "description": "Job not found"
                  }
                }
              }
            },
            "/jobs/import": {
              "post": {
                "tags": [
                  "jobs"
                ],
                "summary": "Import a single job",
                "security": [
                  {
                    "BearerAuth": []
                  }
                ],
                "responses": {
                  "201": {
                    "description": "Job imported successfully"
                  },
                  "401": {
                    "description": "Unauthorized"
                  },
                  "403": {
                    "description": "Forbidden"
                  }
                }
              }
            },
            "/jobs/import/batch": {
              "post": {
                "tags": [
                  "jobs"
                ],
                "summary": "Batch import jobs",
                "security": [
                  {
                    "BearerAuth": []
                  }
                ],
                "responses": {
                  "201": {
                    "description": "Batch import completed"
                  },
                  "401": {
                    "description": "Unauthorized"
                  },
                  "403": {
                    "description": "Forbidden"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Company Management API",
        "description": "Company CRUD operations with pagination for managing company profiles",
        "files": [
          "src/routes/companies.ts",
          "src/services/companies/company.service.ts"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Company Management API",
            "version": "1.0.0"
          },
          "paths": {
            "/companies": {
              "post": {
                "tags": [
                  "companies"
                ],
                "summary": "Create a new company",
                "security": [
                  {
                    "BearerAuth": []
                  }
                ],
                "requestBody": {
                  "required": true,
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "name": {
                            "type": "string",
                            "minLength": 1
                          },
                          "description": {
                            "type": "string",
                            "minLength": 1
                          },
                          "website": {
                            "type": "string",
                            "format": "uri"
                          },
                          "logo": {
                            "type": "string",
                            "format": "uri"
                          }
                        }
                      }
                    }
                  }
                },
                "responses": {
                  "201": {
                    "description": "Company created successfully"
                  },
                  "401": {
                    "description": "Unauthorized"
                  },
                  "403": {
                    "description": "Forbidden"
                  }
                }
              },
              "get": {
                "tags": [
                  "companies"
                ],
                "summary": "Get all companies with pagination",
                "parameters": [
                  {
                    "name": "page",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  },
                  {
                    "name": "limit",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Companies retrieved successfully"
                  }
                }
              }
            },
            "/companies/{id}": {
              "get": {
                "tags": [
                  "companies"
                ],
                "summary": "Get company by ID",
                "parameters": [
                  {
                    "name": "id",
                    "in": "path",
                    "required": true,
                    "schema": {
                      "type": "string"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Company retrieved successfully"
                  },
                  "404": {
                    "description": "Company not found"
                  }
                }
              },
              "put": {
                "tags": [
                  "companies"
                ],
                "summary": "Update company",
                "security": [
                  {
                    "BearerAuth": []
                  }
                ],
                "parameters": [
                  {
                    "name": "id",
                    "in": "path",
                    "required": true,
                    "schema": {
                      "type": "string"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Company updated successfully"
                  },
                  "401": {
                    "description": "Unauthorized"
                  },
                  "403": {
                    "description": "Forbidden"
                  },
                  "404": {
                    "description": "Company not found"
                  }
                }
              },
              "delete": {
                "tags": [
                  "companies"
                ],
                "summary": "Delete company",
                "security": [
                  {
                    "BearerAuth": []
                  }
                ],
                "parameters": [
                  {
                    "name": "id",
                    "in": "path",
                    "required": true,
                    "schema": {
                      "type": "string"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Company deleted successfully"
                  },
                  "401": {
                    "description": "Unauthorized"
                  },
                  "403": {
                    "description": "Forbidden"
                  },
                  "404": {
                    "description": "Company not found"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Comments API",
        "description": "Comment system for jobs with support for replies and CRUD operations",
        "files": [
          "src/routes/comments.ts",
          "src/services/comments/comment.service.ts"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Comments API",
            "version": "1.0.0"
          },
          "paths": {
            "/comments": {
              "post": {
                "tags": [
                  "comments"
                ],
                "summary": "Create a new comment",
                "security": [
                  {
                    "BearerAuth": []
                  }
                ],
                "requestBody": {
                  "required": true,
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "content": {
                            "type": "string",
                            "minLength": 1
                          },
                          "jobId": {
                            "type": "string"
                          },
                          "parentId": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                },
                "responses": {
                  "201": {
                    "description": "Comment created successfully"
                  },
                  "401": {
                    "description": "Unauthorized"
                  }
                }
              }
            },
            "/comments/job/{jobId}": {
              "get": {
                "tags": [
                  "comments"
                ],
                "summary": "Get comments for a job with pagination",
                "parameters": [
                  {
                    "name": "jobId",
                    "in": "path",
                    "required": true,
                    "schema": {
                      "type": "string"
                    }
                  },
                  {
                    "name": "page",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  },
                  {
                    "name": "limit",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Comments retrieved successfully"
                  }
                }
              }
            },
            "/comments/{id}": {
              "put": {
                "tags": [
                  "comments"
                ],
                "summary": "Update comment",
                "security": [
                  {
                    "BearerAuth": []
                  }
                ],
                "parameters": [
                  {
                    "name": "id",
                    "in": "path",
                    "required": true,
                    "schema": {
                      "type": "string"
                    }
                  }
                ],
                "requestBody": {
                  "required": true,
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "content": {
                            "type": "string",
                            "minLength": 1
                          }
                        }
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "Comment updated successfully"
                  },
                  "401": {
                    "description": "Unauthorized"
                  },
                  "403": {
                    "description": "Forbidden"
                  },
                  "404": {
                    "description": "Comment not found"
                  }
                }
              },
              "delete": {
                "tags": [
                  "comments"
                ],
                "summary": "Delete comment",
                "security": [
                  {
                    "BearerAuth": []
                  }
                ],
                "parameters": [
                  {
                    "name": "id",
                    "in": "path",
                    "required": true,
                    "schema": {
                      "type": "string"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Comment deleted successfully"
                  },
                  "401": {
                    "description": "Unauthorized"
                  },
                  "403": {
                    "description": "Forbidden"
                  },
                  "404": {
                    "description": "Comment not found"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Likes API",
        "description": "Like system for jobs and comments with like count and status tracking",
        "files": [
          "src/routes/likes.ts",
          "src/services/likes/like.service.ts"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Likes API",
            "version": "1.0.0"
          },
          "paths": {
            "/likes": {
              "post": {
                "tags": [
                  "likes"
                ],
                "summary": "Like a job or comment",
                "security": [
                  {
                    "BearerAuth": []
                  }
                ],
                "requestBody": {
                  "required": true,
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "jobId": {
                            "type": "string"
                          },
                          "commentId": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "Liked successfully"
                  },
                  "400": {
                    "description": "Bad request"
                  },
                  "401": {
                    "description": "Unauthorized"
                  },
                  "409": {
                    "description": "Already liked"
                  }
                }
              },
              "delete": {
                "tags": [
                  "likes"
                ],
                "summary": "Unlike a job or comment",
                "security": [
                  {
                    "BearerAuth": []
                  }
                ],
                "parameters": [
                  {
                    "name": "jobId",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  },
                  {
                    "name": "commentId",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Unliked successfully"
                  },
                  "400": {
                    "description": "Bad request"
                  },
                  "401": {
                    "description": "Unauthorized"
                  }
                }
              }
            },
            "/likes/count": {
              "get": {
                "tags": [
                  "likes"
                ],
                "summary": "Get like count for a job or comment",
                "parameters": [
                  {
                    "name": "jobId",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  },
                  {
                    "name": "commentId",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Like count retrieved successfully"
                  },
                  "400": {
                    "description": "Bad request"
                  }
                }
              }
            },
            "/likes/has-liked": {
              "get": {
                "tags": [
                  "likes"
                ],
                "summary": "Check if user has liked a job or comment",
                "security": [
                  {
                    "BearerAuth": []
                  }
                ],
                "parameters": [
                  {
                    "name": "jobId",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  },
                  {
                    "name": "commentId",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Like status retrieved successfully"
                  },
                  "400": {
                    "description": "Bad request"
                  },
                  "401": {
                    "description": "Unauthorized"
                  }
                }
              }
            }
          }
        }
      }
    ]
  }
}
